<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ruoyuan Qian" />

<meta name="date" content="2019-11-15" />

<title>Untitled</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.46.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 52px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h2 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h3 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h4 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h5 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h6 {
  padding-top: 57px;
  margin-top: -57px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Project Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">Final report</a>
</li>
<li>
  <a href="data.html">Data</a>
</li>
<li>
  <a href="https://yuqimiao.shinyapps.io/Gaotong/">Associaiton Map</a>
</li>
<li>
  <a href="global_animation_plot.html">Global Animation Map</a>
</li>
<li>
  <a href="mailto:&lt;gl2677@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/GaotongLIU/P8105_final_report.io.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="section-header">



<h1 class="title toc-ignore">Untitled</h1>
<h4 class="author">Ruoyuan Qian</h4>
<h4 class="date">11/15/2019</h4>

</div>


<pre class="r"><code>library(plotly)
library(shiny)
library(tidyverse)
library(rworldmap)
library(arsenal)
library(leaflet)
library(rworldmap) 
library(countrycode)  # Gets country code 
library(viridis)</code></pre>
<pre class="r"><code>happy = read_csv(&quot;data/final_data.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  select(-long,-lat) %&gt;% 
  unique %&gt;% 
  mutate(label = str_c(&quot;&lt;b&gt;Happiness: &quot;, round(life_ladder,2), 
                      &quot;&lt;/b&gt;&lt;br&gt;Country : &quot;, country_name,
                      sep = &quot;&quot;),
        code = countrycode(country_name, &#39;country.name&#39;, &#39;iso3c&#39;),## match code
        code = replace_na(code,&quot;XKX&quot;))</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   country_name = col_character(),
##   year = col_double(),
##   life_ladder = col_double(),
##   log_gdp_per_capita = col_double(),
##   social_support = col_double(),
##   healthy_life_expectancy_at_birth = col_double(),
##   freedom_to_make_life_choices = col_double(),
##   positive_affect = col_double(),
##   negative_affect = col_double(),
##   generosity = col_double(),
##   perceptions_of_corruption = col_double(),
##   long = col_double(),
##   lat = col_double()
## )</code></pre>
<pre><code>## Warning in countrycode(country_name, &quot;country.name&quot;, &quot;iso3c&quot;): Some values were not matched unambiguously: Kosovo</code></pre>
<pre class="r"><code># light grey boundaries
l &lt;- list(color = toRGB(&quot;grey&quot;), width = 0.5)

# specify map projection/options
g &lt;- list(
  showframe = FALSE,
  showcoastlines = FALSE,
  projection = list(type = &#39;Mercator&#39;)
)</code></pre>
<pre class="r"><code>location = read_csv(&quot;data/concap.csv&quot;) %&gt;% 
  janitor::clean_names() </code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   CountryName = col_character(),
##   CapitalName = col_character(),
##   CapitalLatitude = col_double(),
##   CapitalLongitude = col_double(),
##   CountryCode = col_character(),
##   ContinentName = col_character()
## )</code></pre>
<pre class="r"><code>happy_location_raw = left_join(happy, location, by = &quot;country_name&quot;)

happy_location_lost = 
happy_location_raw %&gt;% 
  filter(country_name %in% c(&quot;Ivory Coast&quot;,&quot;UK&quot;,&quot;USA&quot;)) %&gt;% 
  mutate(
    capital_longitude = c(c(rep(-5.3,6)),c(rep(-0.116667,8)),c(rep(-77.013222,8))),
    capital_latitude = 
c(c(rep(6.85,6)),c(rep(51.5,8)),c(rep(38.913611,8)))
  )



happy_location = 
bind_rows(happy_location_raw,happy_location_lost) %&gt;% 
  drop_na(capital_latitude,capital_longitude)</code></pre>
<pre class="r"><code> happy_location_2018 = happy_location %&gt;% 
    filter(year == 2018)</code></pre>
<p>问题： 1.点太大，不会改 2.如何只改变点的透明度 3.点的大小太接近</p>
<pre class="r"><code> happy_location_2018 %&gt;%
  plot_geo(marker = list(color = toRGB(&quot;purple&quot;),
                       #opacity = 0.5,    #用了整个地图会一起透明
                       #size = 0.5,
                       line = list(color = toRGB(&quot;purple&quot;),
                                   width = 0.1))) %&gt;%  
  add_trace(
    z = ~life_ladder, color = ~life_ladder, colors = &#39;Blues&#39;,
    text = ~label, locations = ~code, marker = list(line = l)
  ) %&gt;%
    add_markers(x = ~capital_longitude,
              y = ~capital_latitude,
              sizes = c(.1, 1), #改了没变化，不知道怎么用
              size = ~social_support,
              hoverinfo = &quot;text&quot;,
              text = ~paste(&#39;country: &#39;, country_name,
                            &#39;&lt;br /&gt; social support: &#39;, social_support)) %&gt;%
  layout(geo = g) %&gt;% 
  colorbar(title = &#39;Happiness index&#39;) </code></pre>
<pre><code>## Warning: `line.width` does not currently support multiple values.</code></pre>
<div id="htmlwidget-6ec16c8b428352dc3fa0" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6ec16c8b428352dc3fa0">{"x":{"visdat":{"fdf71ceee72d":["function () ","plotlyVisDat"]},"cur_data":"fdf71ceee72d","attrs":{"fdf71ceee72d":{"marker":{"color":"rgba(160,32,240,1)","line":{"color":"rgba(160,32,240,1)","width":0.1}},"alpha_stroke":1,"sizes":[0.1,1],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","size":{},"hoverinfo":"text","text":{},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"mapType":"geo","geo":{"domain":{"x":[0,1],"y":[0,1]},"showframe":false,"showcoastlines":false,"projection":{"type":"Mercator"}},"scene":{"zaxis":{"title":"life_ladder"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"Happiness index","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(247,251,255,1)"],["0.0416666666666667","rgba(239,246,252,1)"],["0.0833333333333333","rgba(230,240,250,1)"],["0.125","rgba(222,235,247,1)"],["0.166666666666667","rgba(214,230,244,1)"],["0.208333333333333","rgba(206,224,242,1)"],["0.25","rgba(198,219,239,1)"],["0.291666666666667","rgba(185,213,234,1)"],["0.333333333333333","rgba(172,208,230,1)"],["0.375","rgba(158,202,225,1)"],["0.416666666666667","rgba(142,193,221,1)"],["0.458333333333333","rgba(125,183,218,1)"],["0.5","rgba(107,174,214,1)"],["0.541666666666667","rgba(94,165,209,1)"],["0.583333333333333","rgba(81,155,203,1)"],["0.625","rgba(66,146,198,1)"],["0.666666666666667","rgba(57,135,192,1)"],["0.708333333333333","rgba(46,124,187,1)"],["0.75","rgba(33,113,181,1)"],["0.791666666666667","rgba(27,102,173,1)"],["0.833333333333334","rgba(19,91,164,1)"],["0.875","rgba(8,81,156,1)"],["0.916666666666667","rgba(9,70,139,1)"],["0.958333333333334","rgba(9,59,123,1)"],["1","rgba(8,48,107,1)"]],"showscale":true,"marker":{"color":"rgba(160,32,240,1)","line":{"colorbar":{"title":"","ticklen":2},"cmin":2.69430327415466,"cmax":7.858107,"colorscale":[["0","rgba(247,251,255,1)"],["0.0416666666666667","rgba(239,246,252,1)"],["0.0833333333333333","rgba(230,240,250,1)"],["0.125","rgba(222,235,247,1)"],["0.166666666666667","rgba(214,230,244,1)"],["0.208333333333333","rgba(206,224,242,1)"],["0.25","rgba(198,219,239,1)"],["0.291666666666667","rgba(185,213,234,1)"],["0.333333333333333","rgba(172,208,230,1)"],["0.375","rgba(158,202,225,1)"],["0.416666666666667","rgba(142,193,221,1)"],["0.458333333333333","rgba(125,183,218,1)"],["0.5","rgba(107,174,214,1)"],["0.541666666666667","rgba(94,165,209,1)"],["0.583333333333333","rgba(81,155,203,1)"],["0.625","rgba(66,146,198,1)"],["0.666666666666667","rgba(57,135,192,1)"],["0.708333333333333","rgba(46,124,187,1)"],["0.75","rgba(33,113,181,1)"],["0.791666666666667","rgba(27,102,173,1)"],["0.833333333333334","rgba(19,91,164,1)"],["0.875","rgba(8,81,156,1)"],["0.916666666666667","rgba(9,70,139,1)"],["0.958333333333334","rgba(9,59,123,1)"],["1","rgba(8,48,107,1)"]],"showscale":false,"color":"rgba(190,190,190,1)","width":0.5}},"z":[2.69430327415466,5.00440263748169,5.04308605194092,5.792797,5.062449,7.176993,7.396002,5.167995,4.499217,5.23377,6.892172,5.819827,5.915734,5.887401,3.461366,6.190922,5.098814,4.927236,3.775283,5.250738,7.175497,4.486325,6.436221,5.983512,3.97282,5.490214,7.141075,5.536271,7.034165,7.648786,5.433216,6.12801,6.276246,6.091302,4.379262,7.858107,6.665904,4.783009,4.659097,7.118364,5.409289,6.626592,5.252227,3.614928,5.908424,3.818069,5.340296,4.278118,6.962336,6.927179,6.516527,5.793575,6.007636,4.655703,5.297383,4.859402,5.901154,5.167187,4.134853,6.308879,7.242631,5.239835,4.070587,3.334634,5.338818,4.41573,4.313615,5.881741,6.549579,5.682277,5.464623,5.65019,4.896792,4.653714,4.410633,4.834088,4.910087,7.463097,7.370286,5.818953,5.164007,5.252288,7.444262,5.471554,6.281434,5.679661,5.869173,5.919823,6.150879,5.5135,3.561047,4.769377,5.936493,4.305683,6.235111,6.249419,4.883922,5.840231,6.513371,4.400223,7.374792,7.508587,3.445023,6.011562,4.022895,4.741132,5.185689,4.321715,4.661909,6.371715,6.20546,5.005663,5.295547,4.041488,3.61648,5.268375,7.233445,6.882685],"text":["<b>Happiness: 2.69<\/b><br>Country : Afghanistan","<b>Happiness: 5<\/b><br>Country : Albania","<b>Happiness: 5.04<\/b><br>Country : Algeria","<b>Happiness: 5.79<\/b><br>Country : Argentina","<b>Happiness: 5.06<\/b><br>Country : Armenia","<b>Happiness: 7.18<\/b><br>Country : Australia","<b>Happiness: 7.4<\/b><br>Country : Austria","<b>Happiness: 5.17<\/b><br>Country : Azerbaijan","<b>Happiness: 4.5<\/b><br>Country : Bangladesh","<b>Happiness: 5.23<\/b><br>Country : Belarus","<b>Happiness: 6.89<\/b><br>Country : Belgium","<b>Happiness: 5.82<\/b><br>Country : Benin","<b>Happiness: 5.92<\/b><br>Country : Bolivia","<b>Happiness: 5.89<\/b><br>Country : Bosnia and Herzegovina","<b>Happiness: 3.46<\/b><br>Country : Botswana","<b>Happiness: 6.19<\/b><br>Country : Brazil","<b>Happiness: 5.1<\/b><br>Country : Bulgaria","<b>Happiness: 4.93<\/b><br>Country : Burkina Faso","<b>Happiness: 3.78<\/b><br>Country : Burundi","<b>Happiness: 5.25<\/b><br>Country : Cameroon","<b>Happiness: 7.18<\/b><br>Country : Canada","<b>Happiness: 4.49<\/b><br>Country : Chad","<b>Happiness: 6.44<\/b><br>Country : Chile","<b>Happiness: 5.98<\/b><br>Country : Colombia","<b>Happiness: 3.97<\/b><br>Country : Comoros","<b>Happiness: 5.49<\/b><br>Country : Democratic Republic of the Congo","<b>Happiness: 7.14<\/b><br>Country : Costa Rica","<b>Happiness: 5.54<\/b><br>Country : Croatia","<b>Happiness: 7.03<\/b><br>Country : Czech Republic","<b>Happiness: 7.65<\/b><br>Country : Denmark","<b>Happiness: 5.43<\/b><br>Country : Dominican Republic","<b>Happiness: 6.13<\/b><br>Country : Ecuador","<b>Happiness: 6.28<\/b><br>Country : El Salvador","<b>Happiness: 6.09<\/b><br>Country : Estonia","<b>Happiness: 4.38<\/b><br>Country : Ethiopia","<b>Happiness: 7.86<\/b><br>Country : Finland","<b>Happiness: 6.67<\/b><br>Country : France","<b>Happiness: 4.78<\/b><br>Country : Gabon","<b>Happiness: 4.66<\/b><br>Country : Georgia","<b>Happiness: 7.12<\/b><br>Country : Germany","<b>Happiness: 5.41<\/b><br>Country : Greece","<b>Happiness: 6.63<\/b><br>Country : Guatemala","<b>Happiness: 5.25<\/b><br>Country : Guinea","<b>Happiness: 3.61<\/b><br>Country : Haiti","<b>Happiness: 5.91<\/b><br>Country : Honduras","<b>Happiness: 3.82<\/b><br>Country : India","<b>Happiness: 5.34<\/b><br>Country : Indonesia","<b>Happiness: 4.28<\/b><br>Country : Iran","<b>Happiness: 6.96<\/b><br>Country : Ireland","<b>Happiness: 6.93<\/b><br>Country : Israel","<b>Happiness: 6.52<\/b><br>Country : Italy","<b>Happiness: 5.79<\/b><br>Country : Japan","<b>Happiness: 6.01<\/b><br>Country : Kazakhstan","<b>Happiness: 4.66<\/b><br>Country : Kenya","<b>Happiness: 5.3<\/b><br>Country : Kyrgyzstan","<b>Happiness: 4.86<\/b><br>Country : Laos","<b>Happiness: 5.9<\/b><br>Country : Latvia","<b>Happiness: 5.17<\/b><br>Country : Lebanon","<b>Happiness: 4.13<\/b><br>Country : Liberia","<b>Happiness: 6.31<\/b><br>Country : Lithuania","<b>Happiness: 7.24<\/b><br>Country : Luxembourg","<b>Happiness: 5.24<\/b><br>Country : Macedonia","<b>Happiness: 4.07<\/b><br>Country : Madagascar","<b>Happiness: 3.33<\/b><br>Country : Malawi","<b>Happiness: 5.34<\/b><br>Country : Malaysia","<b>Happiness: 4.42<\/b><br>Country : Mali","<b>Happiness: 4.31<\/b><br>Country : Mauritania","<b>Happiness: 5.88<\/b><br>Country : Mauritius","<b>Happiness: 6.55<\/b><br>Country : Mexico","<b>Happiness: 5.68<\/b><br>Country : Moldova","<b>Happiness: 5.46<\/b><br>Country : Mongolia","<b>Happiness: 5.65<\/b><br>Country : Montenegro","<b>Happiness: 4.9<\/b><br>Country : Morocco","<b>Happiness: 4.65<\/b><br>Country : Mozambique","<b>Happiness: 4.41<\/b><br>Country : Myanmar","<b>Happiness: 4.83<\/b><br>Country : Namibia","<b>Happiness: 4.91<\/b><br>Country : Nepal","<b>Happiness: 7.46<\/b><br>Country : Netherlands","<b>Happiness: 7.37<\/b><br>Country : New Zealand","<b>Happiness: 5.82<\/b><br>Country : Nicaragua","<b>Happiness: 5.16<\/b><br>Country : Niger","<b>Happiness: 5.25<\/b><br>Country : Nigeria","<b>Happiness: 7.44<\/b><br>Country : Norway","<b>Happiness: 5.47<\/b><br>Country : Pakistan","<b>Happiness: 6.28<\/b><br>Country : Panama","<b>Happiness: 5.68<\/b><br>Country : Peru","<b>Happiness: 5.87<\/b><br>Country : Philippines","<b>Happiness: 5.92<\/b><br>Country : Portugal","<b>Happiness: 6.15<\/b><br>Country : Romania","<b>Happiness: 5.51<\/b><br>Country : Russia","<b>Happiness: 3.56<\/b><br>Country : Rwanda","<b>Happiness: 4.77<\/b><br>Country : Senegal","<b>Happiness: 5.94<\/b><br>Country : Serbia","<b>Happiness: 4.31<\/b><br>Country : Sierra Leone","<b>Happiness: 6.24<\/b><br>Country : Slovakia","<b>Happiness: 6.25<\/b><br>Country : Slovenia","<b>Happiness: 4.88<\/b><br>Country : South Africa","<b>Happiness: 5.84<\/b><br>Country : South Korea","<b>Happiness: 6.51<\/b><br>Country : Spain","<b>Happiness: 4.4<\/b><br>Country : Sri Lanka","<b>Happiness: 7.37<\/b><br>Country : Sweden","<b>Happiness: 7.51<\/b><br>Country : Switzerland","<b>Happiness: 3.45<\/b><br>Country : Tanzania","<b>Happiness: 6.01<\/b><br>Country : Thailand","<b>Happiness: 4.02<\/b><br>Country : Togo","<b>Happiness: 4.74<\/b><br>Country : Tunisia","<b>Happiness: 5.19<\/b><br>Country : Turkey","<b>Happiness: 4.32<\/b><br>Country : Uganda","<b>Happiness: 4.66<\/b><br>Country : Ukraine","<b>Happiness: 6.37<\/b><br>Country : Uruguay","<b>Happiness: 6.21<\/b><br>Country : Uzbekistan","<b>Happiness: 5.01<\/b><br>Country : Venezuela","<b>Happiness: 5.3<\/b><br>Country : Vietnam","<b>Happiness: 4.04<\/b><br>Country : Zambia","<b>Happiness: 3.62<\/b><br>Country : Zimbabwe","<b>Happiness: 5.27<\/b><br>Country : Ivory Coast","<b>Happiness: 7.23<\/b><br>Country : UK","<b>Happiness: 6.88<\/b><br>Country : USA"],"locations":["AFG","ALB","DZA","ARG","ARM","AUS","AUT","AZE","BGD","BLR","BEL","BEN","BOL","BIH","BWA","BRA","BGR","BFA","BDI","CMR","CAN","TCD","CHL","COL","COM","COD","CRI","HRV","CZE","DNK","DOM","ECU","SLV","EST","ETH","FIN","FRA","GAB","GEO","DEU","GRC","GTM","GIN","HTI","HND","IND","IDN","IRN","IRL","ISR","ITA","JPN","KAZ","KEN","KGZ","LAO","LVA","LBN","LBR","LTU","LUX","MKD","MDG","MWI","MYS","MLI","MRT","MUS","MEX","MDA","MNG","MNE","MAR","MOZ","MMR","NAM","NPL","NLD","NZL","NIC","NER","NGA","NOR","PAK","PAN","PER","PHL","PRT","ROU","RUS","RWA","SEN","SRB","SLE","SVK","SVN","ZAF","KOR","ESP","LKA","SWE","CHE","TZA","THA","TGO","TUN","TUR","UGA","UKR","URY","UZB","VEN","VNM","ZMB","ZWE","CIV","GBR","USA"],"type":"choropleth","geo":"geo","frame":null},{"marker":{"color":"rgba(160,32,240,1)","size":[14.2640464681956,47.1927365847266,68.7105374148511,87.6476514020771,71.6649257023477,95.1704312985419,89.8462846602377,65.4524799858368,51.3003808649493,88.5187077646455,93.2401074126846,13.5212542756137,74.0419705735125,75.6746238467713,68.0157162636128,84.2054106552835,92.1250909356885,43.6895546504527,10,45.9273112937709,91.9129232470581,27.3060012671256,85.8099182809981,82.2352340286178,35.5438676254819,35.4166792208653,83.1519779771996,89.4981950006099,93.1182489147458,98.5519485120625,80.5550791309322,78.5650041860027,73.4509493779386,93.7783905842887,57.7707940646658,99.2880553778343,91.6780894289768,66.1253012228447,34.7800265435586,91.3601651710027,67.7473133841749,76.6503894987748,37.2513266064993,19.9605108980487,74.0246717535933,38.6761696236047,70.7167446550802,45.3549541222828,94.7449925370917,89.4586601840595,90.0310547584015,85.1267551548925,94.5195094324802,51.5180467730999,87.3177956337155,51.1474218940099,90.1470410082812,74.4573479672692,55.2639799919667,93.1530709717074,88.0741935477168,78.110596914223,43.8117684755033,18.0656075148152,66.9820135909503,48.7388651184517,69.2611377906591,89.3176888277883,79.8224694319982,86.1830117484442,95.4279125446471,79.431740518948,22.9123254247769,57.457713476269,64.0678263352247,80.9718404302824,63.0410431905299,95.0406246941537,97.7372769517173,79.1132365167387,33.8088801440093,57.9016479489626,100,47.467242892263,88.4851387032888,77.4347647474777,77.5286272092879,85.2541866780593,72.3160158812518,89.296088679673,34.5844283191968,57.6212387534294,78.864283121318,40.8429917545408,91.8493196940363,95.3263824977917,76.6946744777678,68.5370746438365,89.5931795480364,74.2113868001588,93.4017064428702,93.3290326977826,45.647762363877,82.6245977375013,30.8780299168805,56.4241043107412,77.7575326750293,57.71216509121,87.8393597296355,90.9024477466547,91.5580075665973,85.2109489789748,74.9369647625636,53.5752972435967,64.3600548325838,35.4652468266276,92.9910792115562,88.3853104862849],"sizemode":"area","line":{"color":"rgba(160,32,240,1)","width":0.1}},"type":"scattergeo","mode":"markers","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"text":["country:  Afghanistan <br /> social support:  0.507515847682953","country:  Albania <br /> social support:  0.683591663837433","country:  Algeria <br /> social support:  0.798651337623596","country:  Argentina <br /> social support:  0.8999116","country:  Armenia <br /> social support:  0.814449","country:  Australia <br /> social support:  0.9401373","country:  Austria <br /> social support:  0.9116681","country:  Azerbaijan <br /> social support:  0.7812299","country:  Bangladesh <br /> social support:  0.705556","country:  Belarus <br /> social support:  0.9045693","country:  Belgium <br /> social support:  0.9298155","country:  Benin <br /> social support:  0.503544","country:  Bolivia <br /> social support:  0.8271595","country:  Bosnia and Herzegovina <br /> social support:  0.8358896","country:  Botswana <br /> social support:  0.794936","country:  Brazil <br /> social support:  0.8815053","country:  Bulgaria <br /> social support:  0.9238533","country:  Burkina Faso <br /> social support:  0.6648595","country:  Burundi <br /> social support:  0.4847152","country:  Cameroon <br /> social support:  0.6768252","country:  Canada <br /> social support:  0.9227188","country:  Chad <br /> social support:  0.5772536","country:  Chile <br /> social support:  0.8900849","country:  Colombia <br /> social support:  0.8709704","country:  Comoros <br /> social support:  0.621303","country:  Democratic Republic of the Congo <br /> social support:  0.6206229","country:  Costa Rica <br /> social support:  0.8758724","country:  Croatia <br /> social support:  0.9098068","country:  Czech Republic <br /> social support:  0.9291639","country:  Denmark <br /> social support:  0.9582189","country:  Dominican Republic <br /> social support:  0.8619863","country:  Ecuador <br /> social support:  0.851345","country:  El Salvador <br /> social support:  0.8239992","country:  Estonia <br /> social support:  0.9326938","country:  Ethiopia <br /> social support:  0.7401545","country:  Finland <br /> social support:  0.962155","country:  France <br /> social support:  0.9214631","country:  Gabon <br /> social support:  0.7848276","country:  Georgia <br /> social support:  0.6172186","country:  Germany <br /> social support:  0.9197631","country:  Greece <br /> social support:  0.7935008","country:  Guatemala <br /> social support:  0.8411072","country:  Guinea <br /> social support:  0.6304331","country:  Haiti <br /> social support:  0.5379759","country:  Honduras <br /> social support:  0.827067","country:  India <br /> social support:  0.638052","country:  Indonesia <br /> social support:  0.8093789","country:  Iran <br /> social support:  0.6737647","country:  Ireland <br /> social support:  0.9378624","country:  Israel <br /> social support:  0.9095954","country:  Italy <br /> social support:  0.9126561","country:  Japan <br /> social support:  0.8864319","country:  Kazakhstan <br /> social support:  0.9366567","country:  Kenya <br /> social support:  0.7067199","country:  Kyrgyzstan <br /> social support:  0.8981478","country:  Laos <br /> social support:  0.7047381","country:  Latvia <br /> social support:  0.9132763","country:  Lebanon <br /> social support:  0.8293806","country:  Liberia <br /> social support:  0.7267501","country:  Lithuania <br /> social support:  0.9293501","country:  Luxembourg <br /> social support:  0.9021924","country:  Macedonia <br /> social support:  0.8489152","country:  Madagascar <br /> social support:  0.665513","country:  Malawi <br /> social support:  0.5278435","country:  Malaysia <br /> social support:  0.7894086","country:  Mali <br /> social support:  0.6918591","country:  Mauritania <br /> social support:  0.8015955","country:  Mauritius <br /> social support:  0.9088416","country:  Mexico <br /> social support:  0.8580689","country:  Moldova <br /> social support:  0.8920799","country:  Mongolia <br /> social support:  0.9415141","country:  Montenegro <br /> social support:  0.8559796","country:  Morocco <br /> social support:  0.5537598","country:  Mozambique <br /> social support:  0.7384804","country:  Myanmar <br /> social support:  0.7738259","country:  Namibia <br /> social support:  0.8642148","country:  Nepal <br /> social support:  0.7683355","country:  Netherlands <br /> social support:  0.9394432","country:  New Zealand <br /> social support:  0.9538627","country:  Nicaragua <br /> social support:  0.8542765","country:  Niger <br /> social support:  0.6120257","country:  Nigeria <br /> social support:  0.7408542","country:  Norway <br /> social support:  0.9659619","country:  Pakistan <br /> social support:  0.6850595","country:  Panama <br /> social support:  0.9043898","country:  Peru <br /> social support:  0.8453014","country:  Philippines <br /> social support:  0.8458033","country:  Portugal <br /> social support:  0.8871133","country:  Romania <br /> social support:  0.8179305","country:  Russia <br /> social support:  0.9087261","country:  Rwanda <br /> social support:  0.6161727","country:  Senegal <br /> social support:  0.7393548","country:  Serbia <br /> social support:  0.8529453","country:  Sierra Leone <br /> social support:  0.6496384","country:  Slovakia <br /> social support:  0.9223787","country:  Slovenia <br /> social support:  0.9409712","country:  South Africa <br /> social support:  0.841344","country:  South Korea <br /> social support:  0.7977238","country:  Spain <br /> social support:  0.9103147","country:  Sri Lanka <br /> social support:  0.8280654","country:  Sweden <br /> social support:  0.9306796","country:  Switzerland <br /> social support:  0.930291","country:  Tanzania <br /> social support:  0.6753304","country:  Thailand <br /> social support:  0.8730524","country:  Togo <br /> social support:  0.5963539","country:  Tunisia <br /> social support:  0.7329535","country:  Turkey <br /> social support:  0.8470273","country:  Uganda <br /> social support:  0.739841","country:  Ukraine <br /> social support:  0.9009367","country:  Uruguay <br /> social support:  0.9173156","country:  Uzbekistan <br /> social support:  0.920821","country:  Venezuela <br /> social support:  0.8868821","country:  Vietnam <br /> social support:  0.8319452","country:  Zambia <br /> social support:  0.7177204","country:  Zimbabwe <br /> social support:  0.7753885","country:  Ivory Coast <br /> social support:  0.6208826","country:  UK <br /> social support:  0.9284839","country:  USA <br /> social support:  0.903856"],"textfont":{"size":[14.2640464681956,47.1927365847266,68.7105374148511,87.6476514020771,71.6649257023477,95.1704312985419,89.8462846602377,65.4524799858368,51.3003808649493,88.5187077646455,93.2401074126846,13.5212542756137,74.0419705735125,75.6746238467713,68.0157162636128,84.2054106552835,92.1250909356885,43.6895546504527,10,45.9273112937709,91.9129232470581,27.3060012671256,85.8099182809981,82.2352340286178,35.5438676254819,35.4166792208653,83.1519779771996,89.4981950006099,93.1182489147458,98.5519485120625,80.5550791309322,78.5650041860027,73.4509493779386,93.7783905842887,57.7707940646658,99.2880553778343,91.6780894289768,66.1253012228447,34.7800265435586,91.3601651710027,67.7473133841749,76.6503894987748,37.2513266064993,19.9605108980487,74.0246717535933,38.6761696236047,70.7167446550802,45.3549541222828,94.7449925370917,89.4586601840595,90.0310547584015,85.1267551548925,94.5195094324802,51.5180467730999,87.3177956337155,51.1474218940099,90.1470410082812,74.4573479672692,55.2639799919667,93.1530709717074,88.0741935477168,78.110596914223,43.8117684755033,18.0656075148152,66.9820135909503,48.7388651184517,69.2611377906591,89.3176888277883,79.8224694319982,86.1830117484442,95.4279125446471,79.431740518948,22.9123254247769,57.457713476269,64.0678263352247,80.9718404302824,63.0410431905299,95.0406246941537,97.7372769517173,79.1132365167387,33.8088801440093,57.9016479489626,100,47.467242892263,88.4851387032888,77.4347647474777,77.5286272092879,85.2541866780593,72.3160158812518,89.296088679673,34.5844283191968,57.6212387534294,78.864283121318,40.8429917545408,91.8493196940363,95.3263824977917,76.6946744777678,68.5370746438365,89.5931795480364,74.2113868001588,93.4017064428702,93.3290326977826,45.647762363877,82.6245977375013,30.8780299168805,56.4241043107412,77.7575326750293,57.71216509121,87.8393597296355,90.9024477466547,91.5580075665973,85.2109489789748,74.9369647625636,53.5752972435967,64.3600548325838,35.4652468266276,92.9910792115562,88.3853104862849]},"line":{"color":"rgba(255,127,14,1)"},"geo":"geo","lat":[34.5166666666667,41.3166666666667,36.75,-34.5833333333333,40.1666666666667,-35.2666666666667,48.2,40.3833333333333,23.7166666666667,53.9,50.8333333333333,6.48333333333333,-16.5,43.8666666666667,-24.6333333333333,-15.7833333333333,42.6833333333333,12.3666666666667,-3.36666666666667,3.86666666666667,45.4166666666667,12.1,-33.45,4.6,-11.7,-4.31666666666667,9.93333333333333,45.8,50.0833333333333,55.6666666666667,18.4666666666667,-0.216666666666667,13.7,59.4333333333333,9.03333333333333,60.1666666666667,48.8666666666667,0.383333333333333,41.6833333333333,52.5166666666667,37.9833333333333,14.6166666666667,9.5,18.5333333333333,14.1,28.6,-6.16666666666667,35.7,53.3166666666667,31.7666666666667,41.9,35.6833333333333,51.1666666666667,-1.28333333333333,42.8666666666667,17.9666666666667,56.95,33.8666666666667,6.3,54.6833333333333,49.6,42,-18.9166666666667,-13.9666666666667,3.16666666666667,12.65,18.0666666666667,-20.15,19.4333333333333,47,47.9166666666667,42.4333333333333,34.0166666666667,-25.95,16.8,-22.5666666666667,27.7166666666667,52.35,-41.3,12.1333333333333,13.5166666666667,9.08333333333333,59.9166666666667,33.6833333333333,8.96666666666667,-12.05,14.6,38.7166666666667,44.4333333333333,55.75,-1.95,14.7333333333333,44.8333333333333,8.48333333333333,48.15,46.05,-25.7,37.55,40.4,6.91666666666667,59.3333333333333,46.9166666666667,-6.8,13.75,6.11666666666667,36.8,39.9333333333333,0.316666666666667,50.4333333333333,-34.85,41.3166666666667,10.4833333333333,21.0333333333333,-15.4166666666667,-17.8166666666667,6.85,51.5,38.913611],"lon":[69.183333,19.816667,3.05,-58.666667,44.5,149.133333,16.366667,49.866667,90.4,27.566667,4.333333,2.616667,-68.15,18.416667,25.9,-47.916667,23.316667,-1.516667,29.35,11.516667,-75.7,15.033333,-70.666667,-74.083333,43.233333,15.3,-84.083333,16,14.466667,12.583333,-69.9,-78.5,-89.2,24.716667,38.7,24.933333,2.333333,9.45,44.833333,13.4,23.733333,-90.516667,-13.7,-72.333333,-87.216667,77.2,106.816667,51.416667,-6.233333,35.233333,12.483333,139.75,71.416667,36.816667,74.6,102.6,24.1,35.5,-10.8,25.316667,6.116667,21.433333,47.516667,33.783333,101.7,-8,-15.966667,57.483333,-99.133333,28.85,106.916667,19.266667,-6.816667,32.583333,96.15,17.083333,85.316667,4.916667,174.783333,-86.25,2.116667,7.533333,10.75,73.05,-79.533333,-77.05,120.966667,-9.133333,26.1,37.6,30.05,-17.633333,20.5,-13.233333,17.116667,14.516667,28.216667,126.983333,-3.683333,79.833333,18.05,7.466667,39.283333,100.516667,1.216667,10.183333,32.866667,32.55,30.516667,-56.166667,69.25,-66.866667,105.85,28.283333,31.033333,-5.3,-0.116667,-77.013222],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div id="section-ym2771-plot-2interaction-relationship-plot-create" class="section level3">
<h3>191115 ym2771 plot 2:interaction relationship plot create</h3>
</div>
<div id="section-make-median-long-and-lat-as-the-plot-point" class="section level2">
<h2>make median long and lat as the plot point</h2>
<pre class="r"><code>library(plotly)
happy = read_csv(&quot;data/final_data.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;%
  group_by(country_name) %&gt;% 
  mutate(med_long = median(long),med_lat = median(lat)) %&gt;% 
  select(-long,-lat) %&gt;% 
  unique %&gt;% 
  mutate(label = str_c(&quot;&lt;b&gt;Happiness: &quot;, round(life_ladder,2), 
                      &quot;&lt;/b&gt;&lt;br&gt;Country : &quot;, country_name,
                      sep = &quot;&quot;),
        code = countrycode(country_name, &#39;country.name&#39;, &#39;iso3c&#39;),## match code
        code = replace_na(code,&quot;XKX&quot;))</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   country_name = col_character(),
##   year = col_double(),
##   life_ladder = col_double(),
##   log_gdp_per_capita = col_double(),
##   social_support = col_double(),
##   healthy_life_expectancy_at_birth = col_double(),
##   freedom_to_make_life_choices = col_double(),
##   positive_affect = col_double(),
##   negative_affect = col_double(),
##   generosity = col_double(),
##   perceptions_of_corruption = col_double(),
##   long = col_double(),
##   lat = col_double()
## )</code></pre>
<pre><code>## Warning in countrycode(country_name, &quot;country.name&quot;, &quot;iso3c&quot;): Some values were not matched unambiguously: Kosovo</code></pre>
</div>
<div id="section-try-to-add-marker-for-variable" class="section level2">
<h2>try to add marker for variable</h2>
<pre class="r"><code>l &lt;- list(color = toRGB(&quot;grey&quot;), width = 0.5)
# specify map projection/options
g &lt;- list(
  showframe = FALSE,
  showcoastlines = FALSE,
  projection = list(type = &#39;Mercator&#39;)
)
## making map according to year
## problem unsolved: How to make it a variable?
global_happy_compare &lt;- function(i,variable){
  happy_yeari_value = happy %&gt;% 
    filter(year == i) %&gt;% 
    select(variable,everything())
  happy_yeari_value %&gt;%
  plot_geo(marker = list(color = toRGB(&quot;purple&quot;),
                       #opacity = 0.5,    #用了整个地图会一起透明
                       #size = 0.5,
                       line = list(color = toRGB(&quot;purple&quot;),
                                   width = 0.1))) %&gt;%  
  add_trace(
    z = ~life_ladder, color = ~life_ladder, colors = &#39;Blues&#39;,
    text = ~label,locations = ~code, marker = list(line = l)
  ) %&gt;%
    add_markers(x = ~med_long,
              y = ~med_lat,
              sizes = c(.1, 1), #改了没变化，不知道怎么用
              size = ~happy_yeari_value[[1]]^3,
              hoverinfo = &quot;text&quot;,
              text = ~paste(&quot;&lt;b&gt;Happiness:&quot; , round(life_ladder,2),
                            &#39;&lt;/b&gt;&lt;br&gt;country: &#39;, country_name,
                            &#39;&lt;/b&gt;&lt;br&gt;&#39;,variable,&#39;: &#39;, round(happy_yeari_value[[1]],2)
                            ) ### how to specify the labels, what format?
              ) %&gt;%
  layout(geo = g) %&gt;% 
  colorbar(title = &#39;Happiness index&#39;)
}</code></pre>
<pre class="r"><code>global_happy_compare(2011,&quot;social_support&quot;)</code></pre>
<pre><code>## Warning: `line.width` does not currently support multiple values.</code></pre>
<div id="htmlwidget-230de7465d3b442d3a66" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-230de7465d3b442d3a66">{"x":{"visdat":{"fdf710b786d":["function () ","plotlyVisDat"]},"cur_data":"fdf710b786d","attrs":{"fdf710b786d":{"marker":{"color":"rgba(160,32,240,1)","line":{"color":"rgba(160,32,240,1)","width":0.1}},"alpha_stroke":1,"sizes":[0.1,1],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","size":{},"hoverinfo":"text","text":{},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"mapType":"geo","geo":{"domain":{"x":[0,1],"y":[0,1]},"showframe":false,"showcoastlines":false,"projection":{"type":"Mercator"}},"scene":{"zaxis":{"title":"life_ladder"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"Happiness index","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(247,251,255,1)"],["0.0416666666666667","rgba(239,246,252,1)"],["0.0833333333333333","rgba(230,240,250,1)"],["0.125","rgba(222,235,247,1)"],["0.166666666666667","rgba(214,230,244,1)"],["0.208333333333333","rgba(206,224,242,1)"],["0.25","rgba(198,219,239,1)"],["0.291666666666667","rgba(185,213,234,1)"],["0.333333333333333","rgba(172,208,230,1)"],["0.375","rgba(158,202,225,1)"],["0.416666666666667","rgba(142,193,221,1)"],["0.458333333333333","rgba(125,183,218,1)"],["0.5","rgba(107,174,214,1)"],["0.541666666666667","rgba(94,165,209,1)"],["0.583333333333333","rgba(81,155,203,1)"],["0.625","rgba(66,146,198,1)"],["0.666666666666667","rgba(57,135,192,1)"],["0.708333333333333","rgba(46,124,187,1)"],["0.75","rgba(33,113,181,1)"],["0.791666666666667","rgba(27,102,173,1)"],["0.833333333333333","rgba(19,91,164,1)"],["0.875","rgba(8,81,156,1)"],["0.916666666666667","rgba(9,70,139,1)"],["0.958333333333333","rgba(9,59,123,1)"],["1","rgba(8,48,107,1)"]],"showscale":true,"marker":{"color":"rgba(160,32,240,1)","line":{"colorbar":{"title":"","ticklen":2},"cmin":2.936221,"cmax":7.788232,"colorscale":[["0","rgba(247,251,255,1)"],["0.0416666666666667","rgba(239,246,252,1)"],["0.0833333333333333","rgba(230,240,250,1)"],["0.125","rgba(222,235,247,1)"],["0.166666666666667","rgba(214,230,244,1)"],["0.208333333333333","rgba(206,224,242,1)"],["0.25","rgba(198,219,239,1)"],["0.291666666666667","rgba(185,213,234,1)"],["0.333333333333333","rgba(172,208,230,1)"],["0.375","rgba(158,202,225,1)"],["0.416666666666667","rgba(142,193,221,1)"],["0.458333333333333","rgba(125,183,218,1)"],["0.5","rgba(107,174,214,1)"],["0.541666666666667","rgba(94,165,209,1)"],["0.583333333333333","rgba(81,155,203,1)"],["0.625","rgba(66,146,198,1)"],["0.666666666666667","rgba(57,135,192,1)"],["0.708333333333333","rgba(46,124,187,1)"],["0.75","rgba(33,113,181,1)"],["0.791666666666667","rgba(27,102,173,1)"],["0.833333333333333","rgba(19,91,164,1)"],["0.875","rgba(8,81,156,1)"],["0.916666666666667","rgba(9,70,139,1)"],["0.958333333333333","rgba(9,59,123,1)"],["1","rgba(8,48,107,1)"]],"showscale":false,"color":"rgba(190,190,190,1)","width":0.5}},"z":[3.83171916007996,5.86742162704468,5.31719446182251,5.5890007019043,6.77580547332764,4.260491,7.405616,7.470513,4.68047,4.823976,4.985649,5.225308,7.111364,3.87028,5.778874,4.994671,3.519921,7.037817,3.875382,4.785367,3.705894,4.161225,4.433885,7.426054,3.677826,4.393482,6.526335,6.463953,3.838486,4.509824,4.516964,7.228889,5.385373,6.689609,6.331491,7.788232,4.369194,5.396535,5.795088,4.174159,4.741295,5.48682,7.354225,6.959185,4.255401,4.203031,6.621312,5.6082,5.37204,5.743354,4.044569,4.844574,4.961031,4.917603,4.634871,5.172608,4.767507,4.725366,7.006904,7.433148,6.057086,5.374446,6.262794,5.735663,4.40531,4.859502,4.921049,4.70375,4.966812,5.187572,4.897515,5.432437,7.1014,4.89818,4.381415,3.946063,5.786367,4.666833,4.784804,5.477073,6.909515,5.792263,5.031174,5.223117,5.084973,4.971112,3.809445,7.563798,7.190638,5.385705,4.55583,5.267186,7.248081,5.677081,5.892457,4.993957,5.646205,5.219998,5.022758,5.388766,4.097436,3.834202,4.815187,4.501644,6.561042,5.945048,6.035964,4.930511,6.946599,6.518249,4.180569,4.314456,7.382232,4.037889,4.262671,4.073562,6.663609,2.936221,4.876482,5.271944,4.826001,5.083133,6.869249,7.115139,6.554047,5.738744,6.579789,5.767344,3.746256,4.999114,4.845642],"text":["<b>Happiness: 3.83<\/b><br>Country : Afghanistan","<b>Happiness: 5.87<\/b><br>Country : Albania","<b>Happiness: 5.32<\/b><br>Country : Algeria","<b>Happiness: 5.59<\/b><br>Country : Angola","<b>Happiness: 6.78<\/b><br>Country : Argentina","<b>Happiness: 4.26<\/b><br>Country : Armenia","<b>Happiness: 7.41<\/b><br>Country : Australia","<b>Happiness: 7.47<\/b><br>Country : Austria","<b>Happiness: 4.68<\/b><br>Country : Azerbaijan","<b>Happiness: 4.82<\/b><br>Country : Bahrain","<b>Happiness: 4.99<\/b><br>Country : Bangladesh","<b>Happiness: 5.23<\/b><br>Country : Belarus","<b>Happiness: 7.11<\/b><br>Country : Belgium","<b>Happiness: 3.87<\/b><br>Country : Benin","<b>Happiness: 5.78<\/b><br>Country : Bolivia","<b>Happiness: 4.99<\/b><br>Country : Bosnia and Herzegovina","<b>Happiness: 3.52<\/b><br>Country : Botswana","<b>Happiness: 7.04<\/b><br>Country : Brazil","<b>Happiness: 3.88<\/b><br>Country : Bulgaria","<b>Happiness: 4.79<\/b><br>Country : Burkina Faso","<b>Happiness: 3.71<\/b><br>Country : Burundi","<b>Happiness: 4.16<\/b><br>Country : Cambodia","<b>Happiness: 4.43<\/b><br>Country : Cameroon","<b>Happiness: 7.43<\/b><br>Country : Canada","<b>Happiness: 3.68<\/b><br>Country : Central African Republic","<b>Happiness: 4.39<\/b><br>Country : Chad","<b>Happiness: 6.53<\/b><br>Country : Chile","<b>Happiness: 6.46<\/b><br>Country : Colombia","<b>Happiness: 3.84<\/b><br>Country : Comoros","<b>Happiness: 4.51<\/b><br>Country : Democratic Republic of the Congo","<b>Happiness: 4.52<\/b><br>Country : Republic of Congo","<b>Happiness: 7.23<\/b><br>Country : Costa Rica","<b>Happiness: 5.39<\/b><br>Country : Croatia","<b>Happiness: 6.69<\/b><br>Country : Cyprus","<b>Happiness: 6.33<\/b><br>Country : Czech Republic","<b>Happiness: 7.79<\/b><br>Country : Denmark","<b>Happiness: 4.37<\/b><br>Country : Djibouti","<b>Happiness: 5.4<\/b><br>Country : Dominican Republic","<b>Happiness: 5.8<\/b><br>Country : Ecuador","<b>Happiness: 4.17<\/b><br>Country : Egypt","<b>Happiness: 4.74<\/b><br>Country : El Salvador","<b>Happiness: 5.49<\/b><br>Country : Estonia","<b>Happiness: 7.35<\/b><br>Country : Finland","<b>Happiness: 6.96<\/b><br>Country : France","<b>Happiness: 4.26<\/b><br>Country : Gabon","<b>Happiness: 4.2<\/b><br>Country : Georgia","<b>Happiness: 6.62<\/b><br>Country : Germany","<b>Happiness: 5.61<\/b><br>Country : Ghana","<b>Happiness: 5.37<\/b><br>Country : Greece","<b>Happiness: 5.74<\/b><br>Country : Guatemala","<b>Happiness: 4.04<\/b><br>Country : Guinea","<b>Happiness: 4.84<\/b><br>Country : Haiti","<b>Happiness: 4.96<\/b><br>Country : Honduras","<b>Happiness: 4.92<\/b><br>Country : Hungary","<b>Happiness: 4.63<\/b><br>Country : India","<b>Happiness: 5.17<\/b><br>Country : Indonesia","<b>Happiness: 4.77<\/b><br>Country : Iran","<b>Happiness: 4.73<\/b><br>Country : Iraq","<b>Happiness: 7.01<\/b><br>Country : Ireland","<b>Happiness: 7.43<\/b><br>Country : Israel","<b>Happiness: 6.06<\/b><br>Country : Italy","<b>Happiness: 5.37<\/b><br>Country : Jamaica","<b>Happiness: 6.26<\/b><br>Country : Japan","<b>Happiness: 5.74<\/b><br>Country : Kazakhstan","<b>Happiness: 4.41<\/b><br>Country : Kenya","<b>Happiness: 4.86<\/b><br>Country : Kosovo","<b>Happiness: 4.92<\/b><br>Country : Kyrgyzstan","<b>Happiness: 4.7<\/b><br>Country : Laos","<b>Happiness: 4.97<\/b><br>Country : Latvia","<b>Happiness: 5.19<\/b><br>Country : Lebanon","<b>Happiness: 4.9<\/b><br>Country : Lesotho","<b>Happiness: 5.43<\/b><br>Country : Lithuania","<b>Happiness: 7.1<\/b><br>Country : Luxembourg","<b>Happiness: 4.9<\/b><br>Country : Macedonia","<b>Happiness: 4.38<\/b><br>Country : Madagascar","<b>Happiness: 3.95<\/b><br>Country : Malawi","<b>Happiness: 5.79<\/b><br>Country : Malaysia","<b>Happiness: 4.67<\/b><br>Country : Mali","<b>Happiness: 4.78<\/b><br>Country : Mauritania","<b>Happiness: 5.48<\/b><br>Country : Mauritius","<b>Happiness: 6.91<\/b><br>Country : Mexico","<b>Happiness: 5.79<\/b><br>Country : Moldova","<b>Happiness: 5.03<\/b><br>Country : Mongolia","<b>Happiness: 5.22<\/b><br>Country : Montenegro","<b>Happiness: 5.08<\/b><br>Country : Morocco","<b>Happiness: 4.97<\/b><br>Country : Mozambique","<b>Happiness: 3.81<\/b><br>Country : Nepal","<b>Happiness: 7.56<\/b><br>Country : Netherlands","<b>Happiness: 7.19<\/b><br>Country : New Zealand","<b>Happiness: 5.39<\/b><br>Country : Nicaragua","<b>Happiness: 4.56<\/b><br>Country : Niger","<b>Happiness: 5.27<\/b><br>Country : Pakistan","<b>Happiness: 7.25<\/b><br>Country : Panama","<b>Happiness: 5.68<\/b><br>Country : Paraguay","<b>Happiness: 5.89<\/b><br>Country : Peru","<b>Happiness: 4.99<\/b><br>Country : Philippines","<b>Happiness: 5.65<\/b><br>Country : Poland","<b>Happiness: 5.22<\/b><br>Country : Portugal","<b>Happiness: 5.02<\/b><br>Country : Romania","<b>Happiness: 5.39<\/b><br>Country : Russia","<b>Happiness: 4.1<\/b><br>Country : Rwanda","<b>Happiness: 3.83<\/b><br>Country : Senegal","<b>Happiness: 4.82<\/b><br>Country : Serbia","<b>Happiness: 4.5<\/b><br>Country : Sierra Leone","<b>Happiness: 6.56<\/b><br>Country : Singapore","<b>Happiness: 5.95<\/b><br>Country : Slovakia","<b>Happiness: 6.04<\/b><br>Country : Slovenia","<b>Happiness: 4.93<\/b><br>Country : South Africa","<b>Happiness: 6.95<\/b><br>Country : South Korea","<b>Happiness: 6.52<\/b><br>Country : Spain","<b>Happiness: 4.18<\/b><br>Country : Sri Lanka","<b>Happiness: 4.31<\/b><br>Country : Sudan","<b>Happiness: 7.38<\/b><br>Country : Sweden","<b>Happiness: 4.04<\/b><br>Country : Syria","<b>Happiness: 4.26<\/b><br>Country : Tajikistan","<b>Happiness: 4.07<\/b><br>Country : Tanzania","<b>Happiness: 6.66<\/b><br>Country : Thailand","<b>Happiness: 2.94<\/b><br>Country : Togo","<b>Happiness: 4.88<\/b><br>Country : Tunisia","<b>Happiness: 5.27<\/b><br>Country : Turkey","<b>Happiness: 4.83<\/b><br>Country : Uganda","<b>Happiness: 5.08<\/b><br>Country : Ukraine","<b>Happiness: 6.87<\/b><br>Country : UK","<b>Happiness: 7.12<\/b><br>Country : USA","<b>Happiness: 6.55<\/b><br>Country : Uruguay","<b>Happiness: 5.74<\/b><br>Country : Uzbekistan","<b>Happiness: 6.58<\/b><br>Country : Venezuela","<b>Happiness: 5.77<\/b><br>Country : Vietnam","<b>Happiness: 3.75<\/b><br>Country : Yemen","<b>Happiness: 5<\/b><br>Country : Zambia","<b>Happiness: 4.85<\/b><br>Country : Zimbabwe"],"locations":["AFG","ALB","DZA","AGO","ARG","ARM","AUS","AUT","AZE","BHR","BGD","BLR","BEL","BEN","BOL","BIH","BWA","BRA","BGR","BFA","BDI","KHM","CMR","CAN","CAF","TCD","CHL","COL","COM","COD","COG","CRI","HRV","CYP","CZE","DNK","DJI","DOM","ECU","EGY","SLV","EST","FIN","FRA","GAB","GEO","DEU","GHA","GRC","GTM","GIN","HTI","HND","HUN","IND","IDN","IRN","IRQ","IRL","ISR","ITA","JAM","JPN","KAZ","KEN","XKX","KGZ","LAO","LVA","LBN","LSO","LTU","LUX","MKD","MDG","MWI","MYS","MLI","MRT","MUS","MEX","MDA","MNG","MNE","MAR","MOZ","NPL","NLD","NZL","NIC","NER","PAK","PAN","PRY","PER","PHL","POL","PRT","ROU","RUS","RWA","SEN","SRB","SLE","SGP","SVK","SVN","ZAF","KOR","ESP","LKA","SDN","SWE","SYR","TJK","TZA","THA","TGO","TUN","TUR","UGA","UKR","GBR","USA","URY","UZB","VEN","VNM","YEM","ZMB","ZWE"],"type":"choropleth","geo":"geo","frame":null},{"marker":{"color":"rgba(160,32,240,1)","size":[21.2964977483917,50.7540501386102,60.0841012113352,44.8012888303101,77.060435696181,42.067401065669,97.0845964332198,90.8589350959663,45.1294482384799,81.5826873290128,29.3984255308623,82.0800705068125,88.9600898042908,18.0539813234501,61.3758058415472,45.1371296460798,70.4383571644568,83.6617648893353,70.4922091045178,42.7264554730578,14.7167350636951,43.6330230379835,47.1713287433307,85.0251083484929,13.0134750440329,61.786705622839,61.833664428223,80.6724368136499,44.6050244123698,32.9321363381132,48.1456718823007,77.7636361996694,56.1742441984193,66.8968996668128,82.9776382059088,95.6173026817586,32.4339877559116,73.1341474359665,61.6284359130031,49.7241011103895,46.0911557375894,81.7904471929943,89.196181293889,84.9280226894262,34.8641383634662,19.876817699533,91.6799440519009,44.9890617077014,68.5887096653479,52.2630523272429,28.5336472574674,25.3518116958441,51.8404633851675,78.1471427756182,24.0023315614173,63.0216037699149,26.8477389482863,49.2780349310051,100,77.9175375344301,82.9275543112107,69.2457687703861,83.7746236796056,80.8734206724578,67.4615180537857,50.6969674580561,77.6109768439752,40.000828167049,65.2965652094046,46.3526202365778,62.8409315454317,82.4566461412018,88.212736612768,55.1701676488255,61.6985383019243,30.0937785430153,52.6706082348941,57.254031786988,49.1987911680012,58.1588220582009,62.8366201295208,72.5301594870717,91.8535235460432,61.5447431842283,64.744733053605,61.5433682948494,47.6581222573237,89.3376237552843,93.4067198800243,58.1649116985319,61.550561813569,20.4078223055988,74.0903662181636,72.4707210310653,50.218339360942,55.9931434729386,80.7775778109013,69.545887000711,49.5909763959648,75.7361821349637,25.6234665642683,28.9574455103475,53.1655641114448,54.6733576916603,80.7520451466799,83.922424056843,87.4545496550761,69.9271690576468,59.8632831603456,90.935188258927,66.5335747033942,61.5754550937354,84.7348262196698,26.1968012174697,49.2763214060444,75.5301289957848,75.9536514142125,10,43.5373363788785,40.1467131529539,75.3494910893313,70.3129095862184,92.0747623301987,85.0341731259566,77.5821572644123,85.6348975404611,87.3134719652833,79.1018743903518,36.1506158813626,71.3230864019317,71.4724869799328],"sizemode":"area","line":{"color":"rgba(160,32,240,1)","width":0.1}},"type":"scattergeo","mode":"markers","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"text":["<b>Happiness: 3.83 <\/b><br>country:  Afghanistan <\/b><br> social_support :  0.52","<b>Happiness: 5.87 <\/b><br>country:  Albania <\/b><br> social_support :  0.76","<b>Happiness: 5.32 <\/b><br>country:  Algeria <\/b><br> social_support :  0.81","<b>Happiness: 5.59 <\/b><br>country:  Angola <\/b><br> social_support :  0.72","<b>Happiness: 6.78 <\/b><br>country:  Argentina <\/b><br> social_support :  0.89","<b>Happiness: 4.26 <\/b><br>country:  Armenia <\/b><br> social_support :  0.71","<b>Happiness: 7.41 <\/b><br>country:  Australia <\/b><br> social_support :  0.97","<b>Happiness: 7.47 <\/b><br>country:  Austria <\/b><br> social_support :  0.94","<b>Happiness: 4.68 <\/b><br>country:  Azerbaijan <\/b><br> social_support :  0.73","<b>Happiness: 4.82 <\/b><br>country:  Bahrain <\/b><br> social_support :  0.91","<b>Happiness: 4.99 <\/b><br>country:  Bangladesh <\/b><br> social_support :  0.61","<b>Happiness: 5.23 <\/b><br>country:  Belarus <\/b><br> social_support :  0.91","<b>Happiness: 7.11 <\/b><br>country:  Belgium <\/b><br> social_support :  0.94","<b>Happiness: 3.87 <\/b><br>country:  Benin <\/b><br> social_support :  0.48","<b>Happiness: 5.78 <\/b><br>country:  Bolivia <\/b><br> social_support :  0.82","<b>Happiness: 4.99 <\/b><br>country:  Bosnia and Herzegovina <\/b><br> social_support :  0.73","<b>Happiness: 3.52 <\/b><br>country:  Botswana <\/b><br> social_support :  0.86","<b>Happiness: 7.04 <\/b><br>country:  Brazil <\/b><br> social_support :  0.92","<b>Happiness: 3.88 <\/b><br>country:  Bulgaria <\/b><br> social_support :  0.86","<b>Happiness: 4.79 <\/b><br>country:  Burkina Faso <\/b><br> social_support :  0.71","<b>Happiness: 3.71 <\/b><br>country:  Burundi <\/b><br> social_support :  0.42","<b>Happiness: 4.16 <\/b><br>country:  Cambodia <\/b><br> social_support :  0.72","<b>Happiness: 4.43 <\/b><br>country:  Cameroon <\/b><br> social_support :  0.74","<b>Happiness: 7.43 <\/b><br>country:  Canada <\/b><br> social_support :  0.92","<b>Happiness: 3.68 <\/b><br>country:  Central African Republic <\/b><br> social_support :  0.39","<b>Happiness: 4.39 <\/b><br>country:  Chad <\/b><br> social_support :  0.82","<b>Happiness: 6.53 <\/b><br>country:  Chile <\/b><br> social_support :  0.82","<b>Happiness: 6.46 <\/b><br>country:  Colombia <\/b><br> social_support :  0.9","<b>Happiness: 3.84 <\/b><br>country:  Comoros <\/b><br> social_support :  0.72","<b>Happiness: 4.51 <\/b><br>country:  Democratic Republic of the Congo <\/b><br> social_support :  0.64","<b>Happiness: 4.52 <\/b><br>country:  Republic of Congo <\/b><br> social_support :  0.74","<b>Happiness: 7.23 <\/b><br>country:  Costa Rica <\/b><br> social_support :  0.89","<b>Happiness: 5.39 <\/b><br>country:  Croatia <\/b><br> social_support :  0.79","<b>Happiness: 6.69 <\/b><br>country:  Cyprus <\/b><br> social_support :  0.84","<b>Happiness: 6.33 <\/b><br>country:  Czech Republic <\/b><br> social_support :  0.91","<b>Happiness: 7.79 <\/b><br>country:  Denmark <\/b><br> social_support :  0.96","<b>Happiness: 4.37 <\/b><br>country:  Djibouti <\/b><br> social_support :  0.63","<b>Happiness: 5.4 <\/b><br>country:  Dominican Republic <\/b><br> social_support :  0.87","<b>Happiness: 5.8 <\/b><br>country:  Ecuador <\/b><br> social_support :  0.82","<b>Happiness: 4.17 <\/b><br>country:  Egypt <\/b><br> social_support :  0.75","<b>Happiness: 4.74 <\/b><br>country:  El Salvador <\/b><br> social_support :  0.73","<b>Happiness: 5.49 <\/b><br>country:  Estonia <\/b><br> social_support :  0.91","<b>Happiness: 7.35 <\/b><br>country:  Finland <\/b><br> social_support :  0.94","<b>Happiness: 6.96 <\/b><br>country:  France <\/b><br> social_support :  0.92","<b>Happiness: 4.26 <\/b><br>country:  Gabon <\/b><br> social_support :  0.65","<b>Happiness: 4.2 <\/b><br>country:  Georgia <\/b><br> social_support :  0.5","<b>Happiness: 6.62 <\/b><br>country:  Germany <\/b><br> social_support :  0.95","<b>Happiness: 5.61 <\/b><br>country:  Ghana <\/b><br> social_support :  0.72","<b>Happiness: 5.37 <\/b><br>country:  Greece <\/b><br> social_support :  0.85","<b>Happiness: 5.74 <\/b><br>country:  Guatemala <\/b><br> social_support :  0.77","<b>Happiness: 4.04 <\/b><br>country:  Guinea <\/b><br> social_support :  0.6","<b>Happiness: 4.84 <\/b><br>country:  Haiti <\/b><br> social_support :  0.57","<b>Happiness: 4.96 <\/b><br>country:  Honduras <\/b><br> social_support :  0.77","<b>Happiness: 4.92 <\/b><br>country:  Hungary <\/b><br> social_support :  0.89","<b>Happiness: 4.63 <\/b><br>country:  India <\/b><br> social_support :  0.55","<b>Happiness: 5.17 <\/b><br>country:  Indonesia <\/b><br> social_support :  0.82","<b>Happiness: 4.77 <\/b><br>country:  Iran <\/b><br> social_support :  0.58","<b>Happiness: 4.73 <\/b><br>country:  Iraq <\/b><br> social_support :  0.75","<b>Happiness: 7.01 <\/b><br>country:  Ireland <\/b><br> social_support :  0.98","<b>Happiness: 7.43 <\/b><br>country:  Israel <\/b><br> social_support :  0.89","<b>Happiness: 6.06 <\/b><br>country:  Italy <\/b><br> social_support :  0.91","<b>Happiness: 5.37 <\/b><br>country:  Jamaica <\/b><br> social_support :  0.85","<b>Happiness: 6.26 <\/b><br>country:  Japan <\/b><br> social_support :  0.92","<b>Happiness: 5.74 <\/b><br>country:  Kazakhstan <\/b><br> social_support :  0.9","<b>Happiness: 4.41 <\/b><br>country:  Kenya <\/b><br> social_support :  0.85","<b>Happiness: 4.86 <\/b><br>country:  Kosovo <\/b><br> social_support :  0.76","<b>Happiness: 4.92 <\/b><br>country:  Kyrgyzstan <\/b><br> social_support :  0.89","<b>Happiness: 4.7 <\/b><br>country:  Laos <\/b><br> social_support :  0.69","<b>Happiness: 4.97 <\/b><br>country:  Latvia <\/b><br> social_support :  0.84","<b>Happiness: 5.19 <\/b><br>country:  Lebanon <\/b><br> social_support :  0.73","<b>Happiness: 4.9 <\/b><br>country:  Lesotho <\/b><br> social_support :  0.82","<b>Happiness: 5.43 <\/b><br>country:  Lithuania <\/b><br> social_support :  0.91","<b>Happiness: 7.1 <\/b><br>country:  Luxembourg <\/b><br> social_support :  0.93","<b>Happiness: 4.9 <\/b><br>country:  Macedonia <\/b><br> social_support :  0.78","<b>Happiness: 4.38 <\/b><br>country:  Madagascar <\/b><br> social_support :  0.82","<b>Happiness: 3.95 <\/b><br>country:  Malawi <\/b><br> social_support :  0.61","<b>Happiness: 5.79 <\/b><br>country:  Malaysia <\/b><br> social_support :  0.77","<b>Happiness: 4.67 <\/b><br>country:  Mali <\/b><br> social_support :  0.8","<b>Happiness: 4.78 <\/b><br>country:  Mauritania <\/b><br> social_support :  0.75","<b>Happiness: 5.48 <\/b><br>country:  Mauritius <\/b><br> social_support :  0.8","<b>Happiness: 6.91 <\/b><br>country:  Mexico <\/b><br> social_support :  0.82","<b>Happiness: 5.79 <\/b><br>country:  Moldova <\/b><br> social_support :  0.87","<b>Happiness: 5.03 <\/b><br>country:  Mongolia <\/b><br> social_support :  0.95","<b>Happiness: 5.22 <\/b><br>country:  Montenegro <\/b><br> social_support :  0.82","<b>Happiness: 5.08 <\/b><br>country:  Morocco <\/b><br> social_support :  0.83","<b>Happiness: 4.97 <\/b><br>country:  Mozambique <\/b><br> social_support :  0.82","<b>Happiness: 3.81 <\/b><br>country:  Nepal <\/b><br> social_support :  0.74","<b>Happiness: 7.56 <\/b><br>country:  Netherlands <\/b><br> social_support :  0.94","<b>Happiness: 7.19 <\/b><br>country:  New Zealand <\/b><br> social_support :  0.95","<b>Happiness: 5.39 <\/b><br>country:  Nicaragua <\/b><br> social_support :  0.8","<b>Happiness: 4.56 <\/b><br>country:  Niger <\/b><br> social_support :  0.82","<b>Happiness: 5.27 <\/b><br>country:  Pakistan <\/b><br> social_support :  0.51","<b>Happiness: 7.25 <\/b><br>country:  Panama <\/b><br> social_support :  0.88","<b>Happiness: 5.68 <\/b><br>country:  Paraguay <\/b><br> social_support :  0.87","<b>Happiness: 5.89 <\/b><br>country:  Peru <\/b><br> social_support :  0.76","<b>Happiness: 4.99 <\/b><br>country:  Philippines <\/b><br> social_support :  0.79","<b>Happiness: 5.65 <\/b><br>country:  Poland <\/b><br> social_support :  0.9","<b>Happiness: 5.22 <\/b><br>country:  Portugal <\/b><br> social_support :  0.86","<b>Happiness: 5.02 <\/b><br>country:  Romania <\/b><br> social_support :  0.75","<b>Happiness: 5.39 <\/b><br>country:  Russia <\/b><br> social_support :  0.88","<b>Happiness: 4.1 <\/b><br>country:  Rwanda <\/b><br> social_support :  0.57","<b>Happiness: 3.83 <\/b><br>country:  Senegal <\/b><br> social_support :  0.6","<b>Happiness: 4.82 <\/b><br>country:  Serbia <\/b><br> social_support :  0.77","<b>Happiness: 4.5 <\/b><br>country:  Sierra Leone <\/b><br> social_support :  0.78","<b>Happiness: 6.56 <\/b><br>country:  Singapore <\/b><br> social_support :  0.9","<b>Happiness: 5.95 <\/b><br>country:  Slovakia <\/b><br> social_support :  0.92","<b>Happiness: 6.04 <\/b><br>country:  Slovenia <\/b><br> social_support :  0.93","<b>Happiness: 4.93 <\/b><br>country:  South Africa <\/b><br> social_support :  0.86","<b>Happiness: 6.95 <\/b><br>country:  South Korea <\/b><br> social_support :  0.81","<b>Happiness: 6.52 <\/b><br>country:  Spain <\/b><br> social_support :  0.94","<b>Happiness: 4.18 <\/b><br>country:  Sri Lanka <\/b><br> social_support :  0.84","<b>Happiness: 4.31 <\/b><br>country:  Sudan <\/b><br> social_support :  0.82","<b>Happiness: 7.38 <\/b><br>country:  Sweden <\/b><br> social_support :  0.92","<b>Happiness: 4.04 <\/b><br>country:  Syria <\/b><br> social_support :  0.58","<b>Happiness: 4.26 <\/b><br>country:  Tajikistan <\/b><br> social_support :  0.75","<b>Happiness: 4.07 <\/b><br>country:  Tanzania <\/b><br> social_support :  0.88","<b>Happiness: 6.66 <\/b><br>country:  Thailand <\/b><br> social_support :  0.88","<b>Happiness: 2.94 <\/b><br>country:  Togo <\/b><br> social_support :  0.3","<b>Happiness: 4.88 <\/b><br>country:  Tunisia <\/b><br> social_support :  0.71","<b>Happiness: 5.27 <\/b><br>country:  Turkey <\/b><br> social_support :  0.69","<b>Happiness: 4.83 <\/b><br>country:  Uganda <\/b><br> social_support :  0.88","<b>Happiness: 5.08 <\/b><br>country:  Ukraine <\/b><br> social_support :  0.86","<b>Happiness: 6.87 <\/b><br>country:  UK <\/b><br> social_support :  0.95","<b>Happiness: 7.12 <\/b><br>country:  USA <\/b><br> social_support :  0.92","<b>Happiness: 6.55 <\/b><br>country:  Uruguay <\/b><br> social_support :  0.89","<b>Happiness: 5.74 <\/b><br>country:  Uzbekistan <\/b><br> social_support :  0.92","<b>Happiness: 6.58 <\/b><br>country:  Venezuela <\/b><br> social_support :  0.93","<b>Happiness: 5.77 <\/b><br>country:  Vietnam <\/b><br> social_support :  0.9","<b>Happiness: 3.75 <\/b><br>country:  Yemen <\/b><br> social_support :  0.66","<b>Happiness: 5 <\/b><br>country:  Zambia <\/b><br> social_support :  0.86","<b>Happiness: 4.85 <\/b><br>country:  Zimbabwe <\/b><br> social_support :  0.86"],"textfont":{"size":[21.2964977483917,50.7540501386102,60.0841012113352,44.8012888303101,77.060435696181,42.067401065669,97.0845964332198,90.8589350959663,45.1294482384799,81.5826873290128,29.3984255308623,82.0800705068125,88.9600898042908,18.0539813234501,61.3758058415472,45.1371296460798,70.4383571644568,83.6617648893353,70.4922091045178,42.7264554730578,14.7167350636951,43.6330230379835,47.1713287433307,85.0251083484929,13.0134750440329,61.786705622839,61.833664428223,80.6724368136499,44.6050244123698,32.9321363381132,48.1456718823007,77.7636361996694,56.1742441984193,66.8968996668128,82.9776382059088,95.6173026817586,32.4339877559116,73.1341474359665,61.6284359130031,49.7241011103895,46.0911557375894,81.7904471929943,89.196181293889,84.9280226894262,34.8641383634662,19.876817699533,91.6799440519009,44.9890617077014,68.5887096653479,52.2630523272429,28.5336472574674,25.3518116958441,51.8404633851675,78.1471427756182,24.0023315614173,63.0216037699149,26.8477389482863,49.2780349310051,100,77.9175375344301,82.9275543112107,69.2457687703861,83.7746236796056,80.8734206724578,67.4615180537857,50.6969674580561,77.6109768439752,40.000828167049,65.2965652094046,46.3526202365778,62.8409315454317,82.4566461412018,88.212736612768,55.1701676488255,61.6985383019243,30.0937785430153,52.6706082348941,57.254031786988,49.1987911680012,58.1588220582009,62.8366201295208,72.5301594870717,91.8535235460432,61.5447431842283,64.744733053605,61.5433682948494,47.6581222573237,89.3376237552843,93.4067198800243,58.1649116985319,61.550561813569,20.4078223055988,74.0903662181636,72.4707210310653,50.218339360942,55.9931434729386,80.7775778109013,69.545887000711,49.5909763959648,75.7361821349637,25.6234665642683,28.9574455103475,53.1655641114448,54.6733576916603,80.7520451466799,83.922424056843,87.4545496550761,69.9271690576468,59.8632831603456,90.935188258927,66.5335747033942,61.5754550937354,84.7348262196698,26.1968012174697,49.2763214060444,75.5301289957848,75.9536514142125,10,43.5373363788785,40.1467131529539,75.3494910893313,70.3129095862184,92.0747623301987,85.0341731259566,77.5821572644123,85.6348975404611,87.3134719652833,79.1018743903518,36.1506158813626,71.3230864019317,71.4724869799328]},"line":{"color":"rgba(255,127,14,1)"},"geo":"geo","lat":[35.5463123321533,40.9333000183105,30.1152324676514,-10.531934261322,-38.4358406066895,40.15808,-22.37847,47.50723,40.072165,26.00234,23.06909,53.59922,50.66294,10.29248,-16.64619,44.027275,-22.53545,-5.250879,42.44097,11.6833,-2.8374025,12.2957,6.1740235,68.26689,6.028125,11.84551,-48.10127,2.483496,-12.08154,-5.316601,-1.920215,9.699267,44.86919,35.08784,50.097485,55.576955,11.58755,18.658325,-0.9523435,28.92773,13.90459,58.53999,63.26176,46.25224,-1.308887,41.887915,51.075905,8.722021,38.21553,15.70322,9.970947,18.77769,14.75244,47.43611,24.59531,-2.766211,34.49179,34.04766,53.80542,31.86641,41.27768,18.0333,34.4647,47.25847,1.042139,42.613505,40.522045,18.40615,56.849535,33.82932,-29.75371,55.13018,49.778685,41.73984,-16.05674,-12.12022,4.253759,14.21704,19.54487,-20.36885,24.76313,47.04321,48.65774,42.759915,28.219705,-16.19316,27.949535,51.97378,-41.41738,13.08562,13.74272,30.10962,8.363183,-23.55703,-5.634863,11.33347,50.817845,39.809475,45.506935,66.409205,-2.195117,13.58623,44.37798,8.485156,1.331445,48.99873,46.214915,-28.58794,35.081665,41.151665,8.944775,12.62373,61.50464,35.293845,39.35708,-6.423487,13.032835,9.2531245,33.87214,39.239135,1.452857,48.13921,55.903785,52.96343,-32.03994,41.1552,8.546143,16.87661,15.3791,-12.2668,-19.041555],"lon":[68.3096694946289,20.2068367004395,1.64736306667328,17.0926761627197,-66.9304733276367,45.410255,137.83575,13.43462,46.403465,50.5749,90.61587,28.2916,4.841504,2.702344,-65.538745,18.48418,24.99893,-54.47768,24.77373,-1.695068,30.185205,105.207,14.173975,-87.02754,19.64292,19.06387,-72.610985,-72.45957,43.78867,25.28311,14.22705,-83.64219,16.233885,33.42422,15.293995,10.63291,42.72246,-70.77205,-80.06104,32.06562,-88.72749,24.01094,23.50186,4.137012,11.68574,43.812355,10.184375,-0.4916992,24.21103,-89.94268,-10.430125,-72.7405,-86.18121,19.462255,85.234375,121.0817,53.37412,45.24112,-8.415235,35.19326,12.05127,-77.233225,134.3723,64.916115,37.68799,20.770755,72.099805,104.0099,25.661675,35.9771,28.17617,24.23662,6.0986815,21.61826,47.440575,34.37598,113.0686,-6.2163815,-12.02344,57.57578,-106.5022,28.49902,102.15835,19.19434,-9.35022,34.75576,84.665775,5.387744,172.8889,-84.2793,4.232715,70.40371,-80.1636,-57.83023,-73.35171,122.7332,18.818115,-7.6286375,23.58164,95.21826,29.97344,-14.34922,20.77246,-12.456495,103.9608,19.66416,14.825585,26.798095,126.7803,-2.192188,80.09746,31.48613,17.97461,36.71758,70.54883,34.77246,100.19085,0.58154295,10.26582,32.86216,31.644875,31.15264,-4.52439,-133.1012,-56.00468,67.922165,-64.70258,106.5022,46.51348,28.94228,29.34004],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div id="section-ym2771-add-shiny-on-plot-2" class="section level3">
<h3>191116 ym2771 Add shiny on plot 2</h3>
<pre class="r"><code>ui &lt;- shinyUI(fluidPage(
  titlePanel(&quot;relationship plot&quot;),
  sidebarPanel(
    selectInput(&#39;year&#39;, &#39;Year&#39;, unique(happy$year),
    selected = &quot;2011&quot;),
    selectInput(&#39;variable&#39;, &#39;Predictor&#39;, names(happy)[3:11],
    selected = &quot;social_support&quot;)),
  mainPanel(
    plotlyOutput(&quot;Plot1&quot;)
  )
))


## instead with world map 

server &lt;- shinyServer(function(input, output) {

  output$Plot1 &lt;- renderPlotly({

    ##plot function
    p &lt;- global_happy_compare(as.numeric(input$year),as.character(input$variable)) 
    ## When having 2 data input, we need to put it together? how could we use it separatly?
    layout(p)
  })
})
shinyApp(ui, server)</code></pre>
<iframe data-deferred-src="app499e82c2f33f41ec55e3b0cd2f7c57b0/?w=&amp;__subapp__=1" width="100%" height="400" class="shiny-frame shiny-frame-deferred"></iframe>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
